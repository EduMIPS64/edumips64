<project name="edumips64" default="jar" basedir=".">
	<target name="init">
		<property name="sourceDir" value="." />
        <property name="helpClassesDir" value="./javahelp_classes" />
		<property name="version" value="0.4" />
		<property name="outputDir" value="edumips" />
		<property name="jarFile" value="edumips64-${version}.jar" />
	</target>

	<target name="docs" depends="init">
		<mkdir dir="${outputDir}/docs" />
		<javadoc destdir="${outputDir}/docs" 
				 author="true"
				 version="true"
				 use="true"
				 sourcepath="."
				 classpath="${sourceDir}/.."
				 packagenames="edumips64.*"/>
	</target>

	<target name="clean">
		<delete file="${jarFile}" />
	</target>

	<target name="jar" depends="init">
		<mkdir dir="${outputDir}" />
        <javac srcdir="${sourceDir}" classpath="${helpClassesDir}" destdir="${outputDir}" nowarn="yes"/>
		<mkdir dir="${outputDir}/edumips64/img" />
		<mkdir dir="${outputDir}/edumips64/data" />
		<mkdir dir="${outputDir}/edumips64/utils" />
		<mkdir dir="${outputDir}/edumips64/help" />

        <!--
		<copy todir="${outputDir}/javax">
            <fileset dir="${helpClassesDir}/javax">
				<include name="**/*.*" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/com">
            <fileset dir="${helpClassesDir}/com">
				<include name="**/*.*" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/edumips64/help">
			<fileset dir="help">
				<include name="**/*.*" />
			</fileset>
		</copy>
        -->
		<copy todir="${outputDir}/edumips64/img">
			<fileset dir="img">
				<include name="**/*.png" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/edumips64/data">
			<fileset dir="data">
				<include name="**/*.txt" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/edumips64/utils">
			<fileset dir="utils">
				<include name="**/*.properties" />
			</fileset>
		</copy>
		<jar destfile="${jarFile}" basedir="edumips">
			<manifest>
				<attribute name="Main-Class" value="edumips64.Main"/>
			</manifest>
		</jar>
		<signjar jar="${jarFile}" keystore="key-edumips" storepass="123456" keypass="123456" alias="edumips64" />
        <delete dir="${outputDir}" /> 
	</target>
</project>
